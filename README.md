# hs-to-lean

This is a project by Tally Holcombe for her Masters in Electrical Engineering and Computer Science Thesis at Chapman University.

The purpose of this project is to convert Haskell programs to its equivalent Lean code.


## Description

The overarching goal of this project is to successfully validate Haskell s ource code by translating it into the [Lean Theorem Prover](https://lean-lang.org/).

Haskell programs are translated in Lean code by first transforming the Abstract Syntax Tree (AST) generated by GHC's [ghc-lib-parser](https://hackage.haskell.org/package/ghc-lib-parser) API into an Algebraic Data Type (ADT). This ADT acts as a common abstract syntax between Haskell and various theorem provers, including Lean, Coq, and Agda. 

It is inspired by the work of Antal Spector-Zabusky, Joachim Breitner, Christine Rizkallah, and Stephanie Weirich in their paper [Total Haskell is Reasonable Coq](https://arxiv.org/abs/1711.09286). Their compiler can be found [here](https://github.com/plclub/hs-to-coq).


## Dependencies

This project requires the following packages: 
* ghc 9.4.8
* ghc-lib-parser
* syb
* filepath

## Compilation


### Compiling with the default program
In the parent directory (hs-to-lean), run the following command to compile and translate the **default** Haskell program, `examples/HeapSort.hs`:
```
cabal build
cabal run hs-to-lean
```

### Compiling a specific program
To compile an translate any other Haskell program, run the following command (in the parent directory):

```
cabal build
cabal run hs-to-lean <filepath> 
```

Pre-existing, testable Haskell programs can all be found in the `examples` directory.  All files intended for translation should be in the `examples` directory. All filepaths entered during compilation should be of the format `examples/...`

If you wish to translate your own Haskell program, make sure your script contains a **module description** at the top of the file. For example:

```haskell
module FileName where
...
```

The Lean translation is written to a lean file and saved in the `LeanOutputs` directory. It is automatically given the module name of the translated Haskell file. 




## Notable Limitations

At present, this tool can translate only a fragment of Haskell. The following list contains the most notable limitations to this compiler:
* Deriving typeclasses
    * Only the Eq and Show typeclasses are supported by this compiler at present
* The IO a (from [Prelude](https://hackage.haskell.org/package/base-4.21.0.0/docs/Prelude.html#t:IO)), specifically for type signatures, is not supported. 
    * Haskell type signatures that use the IO monad, e.g. the main function, must have an implicit type signature for proper translation to Lean
* Language extensions
    * This tool does not support features provided by [language extentions](https://hackage.haskell.org/package/template-haskell-2.23.0.0/docs/Language-Haskell-TH.html#g:5).
* This tool has not yet been tested for modularity.

